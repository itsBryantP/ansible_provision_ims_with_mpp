deprovision-zcee
=========

This role is used to deprovision an existing zCEE server.

Requirements
------------

None

Role Variables
--------------

| Variable                    | Definition                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| --------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| DFS_AUTH_LIB_HLQ1           | The first HLQ to be used to store middleware (IMS, zCEE, etc) related datasets. these include procs, OLDS, WADS, PROCLIB, JOBS, and application specific datasets.                                                                                                                                                                                                                                                                                                                            |
| DYNAMICALLY_RESERVE_PORTS   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| HOSTNAME                    | The hostname for the z/OS system                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| JAVA_HOME                   | must define the z/OS UNIX path up to, but not including, the "bin" directory                                                                                                                                                                                                                                                                                                                                                                                                                  |
| JOB_CARD                    | The default job card inserted for dynamically generated JCL. ensure MSGCLASS and CLASS are correct for desired environment.                                                                                                                                                                                                                                                                                                                                                                   |
| TARGET_USERNAME             | The z/OS username to use for job submission.                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| TCPIP_PROFILE               | the location of the TCPIP profile information, used to allocate ports                                                                                                                                                                                                                                                                                                                                                                                                                         |
| TCPIP_PROFILE_TMP           | the location to save the temporary TCPIP profile information to use during TCPIP updates                                                                                                                                                                                                                                                                                                                                                                                                      |
| TEMP_DIR                    | the directory to use as a temporary directory (i.e. /tmp)                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| ZCEE_CONFIG_PATH            | the path to the base zCEE configuration directory                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ZCON_ADMIN_SERVER           | User ID under which the provisioned instance of z/OS Connect EE runs.                                                                                                                                                                                                                                                                                                                                                                                                                         |
| ZCON_ADMIN_TSO              | User ID that can be used in the step to create the procedure in the PROCLIB named by the ZCON_ZOS_PROCLIB variable for the instance of z/OS Connect EE.                                                                                                                                                                                                                                                                                                                                       |
| ZCON_ADMIN_ZFS              | User ID that has zFS authority to mount and unmount zFS file systems that are used by the z/OS Connect EE instance.                                                                                                                                                                                                                                                                                                                                                                           |
| ZCON_FILE_SYSTEM_HLQ        | Specifies the high-level qualifier for the zFS data sets that are defined during the provisioning of the z/OS Connect EE instance.                                                                                                                                                                                                                                                                                                                                                            |
| ZCON_HOSTNAME               | The host name of the system running zCEE                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| ZCON_HTTPS_PORT             | HTTPS port for zCEE, may be determined at runtime                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ZCON_HTTP_PORT              | HTTP port for zCEE, may be determined at runtime                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| ZCON_INSTALL_DIR            | The path to the z/OS Connect EE installation directory on zFS.                                                                                                                                                                                                                                                                                                                                                                                                                                |
| ZCON_SAF_AUTHENTICATION     | value of 'TRUE' or 'FALSE' specifying if zos connect should require authentication                                                                                                                                                                                                                                                                                                                                                                                                            |
| ZCON_SERVER_KEYRING         | address of zos connect server keyring if needed                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| ZCON_STC_JOB_CARD           | Specifies the job card to use for the started task of the provisioned instance of z/OS Connect EE. When specified, ZCON_ZOS_STCJOBS must also be used to indicate the data set prefix for STCJOBS.                                                                                                                                                                                                                                                                                            |
| ZCON_TLS                    | value of 'YES' or 'NO' used to specify if zos connect should accept SSL connections                                                                                                                                                                                                                                                                                                                                                                                                           |
| ZCON_ZFS_DATACLASS          | Specifies a data class that is used to define a zFS data set for the z/OS Connect EE instance.                                                                                                                                                                                                                                                                                                                                                                                                |
| ZCON_ZFS_GROUP              | Specifies the name of a SAF group, which is granted read, write and run authority to the z/OS Connect EE instances data directory.                                                                                                                                                                                                                                                                                                                                                            |
| ZCON_ZFS_MOUNTPOINT         | the path to the zCEE mount point                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| ZCON_ZOS_GUEST_USER         | user ID to get unauthenticated READ access to profile in APPL class                                                                                                                                                                                                                                                                                                                                                                                                                           |
| ZCON_ZOS_PROCLIB            | the PROCLIB holding zCEE related procedures                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| ZCON_ZOS_STCJOBS            | Names the data set into which the workflow can create the source JCL that defines the job level characteristics of the started task for the provisioned instance of z/OS Connect EE. Used only when ZCON_STC_JOB_CARD is also specified.  If you specify a data set of type PDSE, it enables concurrent addition of new STCJOBS to the data set. If a PDS is used and multiple concurrent updates to the data set are attempted, z/OS produces a 213-30 abend code, to avoid data corruption. |
| ZCON_ZOS_VSAM_VOLUME        | VOLUME value that is used in the creation of the zFS data sets, for example, SYSDA. If the value is specified as SMS (Storage Management Subsystem), the VOLUME parameter is omitted from the VSAM creation.                                                                                                                                                                                                                                                                                  |
| define_keyring              | boolean used to determine if a keyring should be defined                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| define_security             | boolean used to determine if security should be defined                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| softwareServiceInstanceName | the unique name for the instance of zCEE                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| uss_file_path               | the path where JCL and other scripts will be stored                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| uss_utilities_path          | where MVSUTILS/MVSCMD and other needed tools/scripts are installed on z/OS target node                                                                                                                                                                                                                                                                                                                                                                                                        |
| workflowOwner               | the ID for the owner of the zCEE application                                                                                                                                                                                                                                                                                                                                                                                                                                                  |

Dependencies
------------

Roles:

* send-template


Example Playbook
----------------

```yaml
  - include_role: 
      name: deprovision-zcee
```

License
-------

BSD

Author Information
------------------

Blake Becker (blake.becker@ibm.com)